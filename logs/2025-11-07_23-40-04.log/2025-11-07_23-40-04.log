[ 2025-11-07 23:40:07,560 ] 29 root - INFO - Starting data ingestion
[ 2025-11-07 23:40:08,371 ] 67 root - INFO - Performed train test split on the dataframe
[ 2025-11-07 23:40:08,372 ] 69 root - INFO - Exited split_data_as_train_test method of Data_Ingestion class
[ 2025-11-07 23:40:08,372 ] 77 root - INFO - Exporting train and test file path.
[ 2025-11-07 23:40:08,380 ] 86 root - INFO - Exported train and test file path.
[ 2025-11-07 23:40:08,380 ] 31 root - INFO - Data ingestion completed
[ 2025-11-07 23:40:08,386 ] 40 root - INFO - Starting data validation
[ 2025-11-07 23:40:08,429 ] 34 root - INFO - Required number of columns:5
[ 2025-11-07 23:40:08,429 ] 35 root - INFO - Data frame has columns:14
[ 2025-11-07 23:40:08,429 ] 34 root - INFO - Required number of columns:5
[ 2025-11-07 23:40:08,429 ] 35 root - INFO - Data frame has columns:14
[ 2025-11-07 23:40:08,459 ] 42 root - INFO - Data validation completed
[ 2025-11-07 23:40:08,459 ] 51 root - INFO - Starting data transformation
[ 2025-11-07 23:40:08,459 ] 271 root - INFO - Entered initiate_data_transformation method of DataTransformation class
[ 2025-11-07 23:40:08,459 ] 273 root - INFO - Starting data transformation
[ 2025-11-07 23:40:08,463 ] 44 root - INFO - Converted temperature: 802/802 values to numeric
[ 2025-11-07 23:40:08,464 ] 44 root - INFO - Converted frequency_crossing: 802/802 values to numeric
[ 2025-11-07 23:40:08,467 ] 44 root - INFO - Converted temperature: 201/201 values to numeric
[ 2025-11-07 23:40:08,467 ] 44 root - INFO - Converted frequency_crossing: 201/201 values to numeric
[ 2025-11-07 23:40:08,467 ] 286 root - INFO - Preprocessing categorical features
[ 2025-11-07 23:40:08,468 ] 156 root - INFO - Preprocessing categorical features for train
[ 2025-11-07 23:40:08,468 ] 165 root - INFO - Converted temperature to numeric in preprocessing
[ 2025-11-07 23:40:08,469 ] 165 root - INFO - Converted frequency_crossing to numeric in preprocessing
[ 2025-11-07 23:40:08,478 ] 76 root - INFO - Creating user-aware features for train
[ 2025-11-07 23:40:08,479 ] 52 root - INFO - Calculating user behavior profiles
[ 2025-11-07 23:40:08,503 ] 71 root - INFO - Calculated behavior profiles for 22 users
[ 2025-11-07 23:40:08,545 ] 151 root - INFO - Created user-aware features: ['temperature_personal_z', 'temperature_personal_pct_max', 'crossing_personal_z', 'unusual_active_hour', 'temperature_personal_z', 'temperature_personal_pct_max', 'crossing_personal_z', 'unusual_active_hour', 'temperature_personal_z', 'temperature_personal_pct_max', 'crossing_personal_z', 'unusual_active_hour', 'temperature_personal_z', 'temperature_personal_pct_max', 'crossing_personal_z', 'unusual_active_hour', 'temperature_personal_z', 'temperature_personal_pct_max', 'crossing_personal_z', 'unusual_active_hour', 'temperature_personal_z', 'temperature_personal_pct_max', 'crossing_personal_z', 'unusual_active_hour', 'temperature_personal_z', 'temperature_personal_pct_max', 'crossing_personal_z', 'unusual_active_hour', 'temperature_personal_z', 'temperature_personal_pct_max', 'crossing_personal_z', 'unusual_active_hour', 'temperature_personal_z', 'temperature_personal_pct_max', 'crossing_personal_z', 'unusual_active_hour', 'temperature_personal_z', 'temperature_personal_pct_max', 'crossing_personal_z', 'unusual_active_hour', 'temperature_personal_z', 'temperature_personal_pct_max', 'crossing_personal_z', 'unusual_active_hour', 'temperature_personal_z', 'temperature_personal_pct_max', 'crossing_personal_z', 'unusual_active_hour', 'temperature_personal_z', 'temperature_personal_pct_max', 'crossing_personal_z', 'unusual_active_hour', 'temperature_personal_z', 'temperature_personal_pct_max', 'crossing_personal_z', 'unusual_active_hour', 'temperature_personal_z', 'temperature_personal_pct_max', 'crossing_personal_z', 'unusual_active_hour', 'temperature_personal_z', 'temperature_personal_pct_max', 'crossing_personal_z', 'unusual_active_hour', 'temperature_personal_z', 'temperature_personal_pct_max', 'crossing_personal_z', 'unusual_active_hour', 'temperature_personal_z', 'temperature_personal_pct_max', 'crossing_personal_z', 'unusual_active_hour', 'temperature_personal_z', 'temperature_personal_pct_max', 'crossing_personal_z', 'unusual_active_hour', 'temperature_personal_z', 'temperature_personal_pct_max', 'crossing_personal_z', 'unusual_active_hour', 'temperature_personal_z', 'temperature_personal_pct_max', 'crossing_personal_z', 'unusual_active_hour', 'temperature_personal_z', 'temperature_personal_pct_max', 'crossing_personal_z', 'unusual_active_hour']
[ 2025-11-07 23:40:08,545 ] 186 root - INFO - After categorical processing - train columns: ['user_id', 'temperature', 'behaviour', 'frequency_crossing', 'anomalous_probability', 'anomaly_reason', 'behavior', 'feature_count', 'normal_probability', 'prediction_confidence', 'prediction_timestamp', 'used_user_model', 'month', 'hour', 'time_of_the_day_encoded', 'temperature_personal_z', 'temperature_personal_pct_max', 'crossing_personal_z', 'unusual_active_hour']
[ 2025-11-07 23:40:08,545 ] 156 root - INFO - Preprocessing categorical features for test
[ 2025-11-07 23:40:08,545 ] 165 root - INFO - Converted temperature to numeric in preprocessing
[ 2025-11-07 23:40:08,545 ] 165 root - INFO - Converted frequency_crossing to numeric in preprocessing
[ 2025-11-07 23:40:08,547 ] 76 root - INFO - Creating user-aware features for test
[ 2025-11-07 23:40:08,585 ] 151 root - INFO - Created user-aware features: ['temperature_personal_z', 'temperature_personal_pct_max', 'crossing_personal_z', 'unusual_active_hour', 'temperature_personal_z', 'temperature_personal_pct_max', 'crossing_personal_z', 'unusual_active_hour', 'temperature_personal_z', 'temperature_personal_pct_max', 'crossing_personal_z', 'unusual_active_hour', 'temperature_personal_z', 'temperature_personal_pct_max', 'crossing_personal_z', 'unusual_active_hour', 'temperature_personal_z', 'temperature_personal_pct_max', 'crossing_personal_z', 'unusual_active_hour', 'temperature_personal_z', 'temperature_personal_pct_max', 'crossing_personal_z', 'unusual_active_hour', 'temperature_personal_z', 'temperature_personal_pct_max', 'crossing_personal_z', 'unusual_active_hour', 'temperature_personal_z', 'temperature_personal_pct_max', 'crossing_personal_z', 'unusual_active_hour', 'temperature_personal_z', 'temperature_personal_pct_max', 'crossing_personal_z', 'unusual_active_hour', 'temperature_personal_z', 'temperature_personal_pct_max', 'crossing_personal_z', 'unusual_active_hour', 'temperature_personal_z', 'temperature_personal_pct_max', 'crossing_personal_z', 'unusual_active_hour', 'temperature_personal_z', 'temperature_personal_pct_max', 'crossing_personal_z', 'unusual_active_hour', 'temperature_personal_z', 'temperature_personal_pct_max', 'crossing_personal_z', 'unusual_active_hour', 'temperature_personal_z', 'temperature_personal_pct_max', 'crossing_personal_z', 'unusual_active_hour', 'temperature_personal_z', 'temperature_personal_pct_max', 'crossing_personal_z', 'unusual_active_hour', 'temperature_personal_z', 'temperature_personal_pct_max', 'crossing_personal_z', 'unusual_active_hour', 'temperature_personal_z', 'temperature_personal_pct_max', 'crossing_personal_z', 'unusual_active_hour', 'temperature_personal_z', 'temperature_personal_pct_max', 'crossing_personal_z', 'unusual_active_hour', 'temperature_personal_z', 'temperature_personal_pct_max', 'crossing_personal_z', 'unusual_active_hour', 'temperature_personal_z', 'temperature_personal_pct_max', 'crossing_personal_z', 'unusual_active_hour']
[ 2025-11-07 23:40:08,586 ] 186 root - INFO - After categorical processing - test columns: ['user_id', 'temperature', 'behaviour', 'frequency_crossing', 'anomalous_probability', 'anomaly_reason', 'behavior', 'feature_count', 'normal_probability', 'prediction_confidence', 'prediction_timestamp', 'used_user_model', 'month', 'hour', 'time_of_the_day_encoded', 'temperature_personal_z', 'temperature_personal_pct_max', 'crossing_personal_z', 'unusual_active_hour']
[ 2025-11-07 23:40:08,586 ] 291 root - INFO - Cleaning target column
[ 2025-11-07 23:40:08,586 ] 191 root - INFO - Cleaning target column for train dataset
[ 2025-11-07 23:40:08,587 ] 199 root - WARNING - Found 2 unmapped behavior values in train
[ 2025-11-07 23:40:08,587 ] 191 root - INFO - Cleaning target column for test dataset
[ 2025-11-07 23:40:08,587 ] 199 root - WARNING - Found 1 unmapped behavior values in test
[ 2025-11-07 23:40:08,587 ] 296 root - INFO - Removing invalid target rows
[ 2025-11-07 23:40:08,589 ] 213 root - WARNING - Removed 2 rows with invalid behavior labels
[ 2025-11-07 23:40:08,589 ] 213 root - WARNING - Removed 1 rows with invalid behavior labels
[ 2025-11-07 23:40:08,589 ] 301 root - INFO - Handling feature missing values
[ 2025-11-07 23:40:08,589 ] 219 root - INFO - Handling missing values for train
[ 2025-11-07 23:40:08,590 ] 228 root - INFO - Found 6385 missing values in train
[ 2025-11-07 23:40:08,591 ] 240 root - INFO - Missing values reduced from 6385 to 6385
[ 2025-11-07 23:40:08,591 ] 219 root - INFO - Handling missing values for test
[ 2025-11-07 23:40:08,591 ] 228 root - INFO - Found 1600 missing values in test
[ 2025-11-07 23:40:08,592 ] 240 root - INFO - Missing values reduced from 1600 to 1600
[ 2025-11-07 23:40:08,592 ] 306 root - INFO - Final train shape: (800, 19), test shape: (200, 19)
[ 2025-11-07 23:40:08,592 ] 315 root - INFO - Creating and fitting preprocessor
[ 2025-11-07 23:40:08,592 ] 246 root - INFO - Creating preprocessing pipeline
[ 2025-11-07 23:40:08,593 ] 259 root - INFO - Numerical features for scaling: ['temperature', 'frequency_crossing', 'anomalous_probability', 'feature_count', 'normal_probability', 'prediction_confidence', 'month', 'hour', 'time_of_the_day_encoded', 'temperature_personal_z', 'temperature_personal_pct_max', 'crossing_personal_z', 'unusual_active_hour']
[ 2025-11-07 23:40:08,593 ] 325 root - INFO - Fitting preprocessor on: ['temperature', 'frequency_crossing', 'anomalous_probability', 'feature_count', 'normal_probability', 'prediction_confidence', 'month', 'hour', 'time_of_the_day_encoded', 'temperature_personal_z', 'temperature_personal_pct_max', 'crossing_personal_z', 'unusual_active_hour']
[ 2025-11-07 23:40:08,595 ] 331 root - INFO - Step 6: Transforming features using preprocessor
[ 2025-11-07 23:40:08,599 ] 339 root - INFO - Saving preprocessor object
[ 2025-11-07 23:40:08,604 ] 40 root - INFO - Entered the save_object method of MainUtils class
[ 2025-11-07 23:40:08,605 ] 44 root - INFO - Exited the save_object method of MainUtils class
[ 2025-11-07 23:40:08,605 ] 40 root - INFO - Entered the save_object method of MainUtils class
[ 2025-11-07 23:40:08,607 ] 44 root - INFO - Exited the save_object method of MainUtils class
[ 2025-11-07 23:40:08,608 ] 40 root - INFO - Entered the save_object method of MainUtils class
[ 2025-11-07 23:40:08,608 ] 44 root - INFO - Exited the save_object method of MainUtils class
[ 2025-11-07 23:40:08,609 ] 40 root - INFO - Entered the save_object method of MainUtils class
[ 2025-11-07 23:40:08,610 ] 44 root - INFO - Exited the save_object method of MainUtils class
[ 2025-11-07 23:40:08,610 ] 357 root - INFO - Saved feature columns: ['temperature', 'frequency_crossing', 'anomalous_probability', 'feature_count', 'normal_probability', 'prediction_confidence', 'month', 'hour', 'time_of_the_day_encoded', 'temperature_personal_z', 'temperature_personal_pct_max', 'crossing_personal_z', 'unusual_active_hour']
[ 2025-11-07 23:40:08,610 ] 40 root - INFO - Entered the save_object method of MainUtils class
[ 2025-11-07 23:40:08,611 ] 44 root - INFO - Exited the save_object method of MainUtils class
[ 2025-11-07 23:40:08,611 ] 361 root - INFO - Saved behavior profiles for 22 users
[ 2025-11-07 23:40:08,611 ] 368 root - INFO - Data transformation completed successfully with user-aware features
[ 2025-11-07 23:40:08,611 ] 53 root - INFO - Data transformation completed
[ 2025-11-07 23:40:08,611 ] 62 root - INFO - Starting model trainer
[ 2025-11-07 23:40:08,611 ] 160 root - INFO - Starting TRUE per-user model training
[ 2025-11-07 23:40:08,638 ] 120 root - INFO - Loaded data with columns: ['temperature', 'frequency_crossing', 'anomalous_probability', 'feature_count', 'normal_probability', 'prediction_confidence', 'month', 'hour', 'time_of_the_day_encoded', 'temperature_personal_z', 'temperature_personal_pct_max', 'crossing_personal_z', 'unusual_active_hour', 'behaviour']
[ 2025-11-07 23:40:08,651 ] 170 root - INFO - Training data: (800, 13), Test data: (200, 13)
[ 2025-11-07 23:40:08,651 ] 171 root - INFO - Train users: 22, Test users: 20
[ 2025-11-07 23:40:08,653 ] 177 root - INFO - Found 18 users with sufficient data for per-user modeling
[ 2025-11-07 23:40:08,656 ] 178 root - INFO - User distribution: count    22.000000
mean     36.454545
std      12.916314
min       1.000000
25%      35.250000
50%      39.500000
75%      42.000000
max      55.000000
Name: count, dtype: float64
[ 2025-11-07 23:40:08,656 ] 283 root - ERROR - TRUE per-user modeling failed: Item wrong length 802 instead of 800.
